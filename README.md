These are my first steps in DSC. I am pretty sure that things can be done in a better way (and someone who knows what's he is doing will come up with very large list of issues to be fixed). But all are working on my machine(TM). If something wipes out your server, wreaks havoc or does something insanely wrong, I am sorry, but you've been warned. Please, drop me a line and I will try to fix the bug.

There are no tests yet. See Examples for proper explanation of resources use.

#Resources:

##[klDeploy](https://github.com/lgramatikov/kelleadsc/tree/master/Resources/klDeploy)
* [klConfigFileKeyValue](https://github.com/lgramatikov/kelleadsc/tree/master/Resources/klDeploy/DSCResources/klConfigFileKeyValue) - sets configuration value or attribute to specific, well, value. For example, change appSettings.

* [klEncryptedConfigurationKey](https://github.com/lgramatikov/kelleadsc/tree/master/Resources/klDeploy/DSCResources/klEncryptedConfigurationKey) - encrypts (using aspnet_regiis) configuration section

* [klSCSwitchMasterToWeb](https://github.com/lgramatikov/kelleadsc/tree/master/Resources/klDeploy/DSCResources/klSCSwitchMasterToWeb) - Sitecore specific, removes "master" database connection string and sets SwitchMasterToWeb.config. This should be done for content distribution nodes.

* [klSQLServerDatabaseConnection](https://github.com/lgramatikov/kelleadsc/tree/master/Resources/klDeploy/DSCResources/klSQLServerDatabaseConnection) - generates EF or SQL server connection string and sets corresponding name in ConnectionStrings.config

##[klUtils](https://github.com/lgramatikov/kelleadsc/tree/master/Resources/klUtils)
* [klWindowsLog](https://github.com/lgramatikov/kelleadsc/tree/master/Resources/klUtils/DSCResources/klWindowsLog) - creates new Windows Log. Resources that is part of DSC adjusts existing log, but does not create new one.

##[klWebAdministration](https://github.com/lgramatikov/kelleadsc/tree/master/Resources/klWebAdministration)
* [klApplicationInitialization](https://github.com/lgramatikov/kelleadsc/tree/master/Resources/klWebAdministration/DSCResources/klApplicationInitialization) - enables IIS Application Initialization for specified site. For warmup pages configuration, use klConfigFileKeyValue. Installing required Windows feature can be done with DSC "Feature" resource.

* [klWebAppPoolCustomRestart](https://github.com/lgramatikov/kelleadsc/tree/master/Resources/klWebAdministration/DSCResources/klWebAppPoolCustomRestart) - custom restart schedule for an application pool. Disables idle timeout.

* [klWebAppPoolSpecificUser](https://github.com/lgramatikov/kelleadsc/tree/master/Resources/klWebAdministration/DSCResources/klWebAppPoolSpecificUser) - sets application pool account to a Windows user

* [klWebSiteCustomLogPath](https://github.com/lgramatikov/kelleadsc/tree/master/Resources/klWebAdministration/DSCResources/klWebSiteCustomLogPath) - sets log file location for a site to specific, non-default location

#[DSC](https://github.com/lgramatikov/kelleadsc/tree/master/DSC) recipes
A bit more complex configuration than the bare-bones samples I could find asking Google.
My idea of installation is less automatic than usual, because most of our customers are quite conservative when it comes to installing third-party software or allowing connections to external world. As we are not aware of configurations for acceptance or production environments, a lot of config files are adjusted during installation.
Technically speaking, I don't think that using DSC for applications' installations is correct. DSC describes your server and installations are more about "action" than "describe and leave DSC to do his magic".

* [Assert_AppBackup](https://github.com/lgramatikov/kelleadsc/blob/master/DSC/Assert_AppBackup.ps1) - copies all home folders to a "backup" location. If something goes horribly wrong, well, rollback is a matter of copying everything back.

* [Assert_AppInstall](https://github.com/lgramatikov/kelleadsc/blob/master/DSC/Assert_AppInstall.ps1) - installs several ASP.NET applications. For Sitecore sites, typically you install "base" site and then on top of it install "your" work. As WebDeploy does sync, it will wipe out "base" Sitecore installation in site's home path. Sync can be disabled, but then using WebDeploy becomes pretty pointless. That's why installation packages are just ZIP files generated by the build.

* [Assert_KelleaDSCResources](https://github.com/lgramatikov/kelleadsc/blob/master/DSC/Assert_KelleaDSCResources.ps1) - installs custom Kellea resources if you have them as a ZIP somewhere.

* [Assert_LCM](https://github.com/lgramatikov/kelleadsc/blob/master/DSC/Assert_LCM.ps1) - enables reboot if needed setting for DSC Local Configuration Manager.

* [Assert_WebBase](https://github.com/lgramatikov/kelleadsc/blob/master/DSC/Assert_WebBase.ps1) - installs Windows features, creates needed folders, sites, bindings, adjusts hosts file, installs base Sitecore package, certificates and washes your clothes if needed.

AppBackup can be part of AppInstall. But on other hand, you'll want installation to take as less time as possible. As such, backup is done before actual installation. KelleaDSCResources and LCM recipes are one time task (well, I don't expect someone to go wild and change these so no need to have DSC checking these every 15 minutes). WebBase takes a lot of time because of Sitecore base package. It makes a lot of sense to have this in PULL mode, but may be without Sitecore part and certificates part.

All scripts use [configuration](https://github.com/lgramatikov/kelleadsc/blob/master/DSC/Configuration.VAT.psd1) file. I am still trying to understand if it is proper. Especially with having role configuration in NonNodeData. Usually this type of configurations are part of node element. But it is pretty big configuration and maintaining it for several nodes is just not feasable.
